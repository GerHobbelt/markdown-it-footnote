{"version":3,"file":"markdownItFootnote.modern.js","sources":["../index.js"],"sourcesContent":["// Process footnotes\n//\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Renderer partials\n\nfunction anchorFnDefault(n, excludeSubId, tokens, idx, options, env, slf) {\n  let prefix = '';\n  if (typeof env.docId === 'string' && env.docId.length > 0) {\n    prefix = '-' + env.docId + '-';\n  }\n  return prefix + n;\n}\n\nfunction captionFnDefault(n, tokens, idx, options, env, slf) {\n  return '[' + n + ']';\n}\n\nfunction headerFnDefault(state) {\n  return '';\n}\n\n\n/*\nref:\n  return `<label aria-describedby=\"fn${id}\" role=\"presentation\" class=\"sidelink\" for=\"fn${id}-content\">\n<a aria-hidden=\"true\" href=\"#fn${id}\"><output class=\"highlight fnref\" id=\"fnref${refid}\">${caption}\n</output></a></label>`;\n\n\nopen:\n  return `<aside id=\"fn${id}\" class=\"sidenote\" role=\"note\">\n    <output aria-hidden=\"true\" class=\"highlight\" id=\"fn${id}-content\">\n    <label role=\"presentation\" for=\"fnref${id}\">`;\n}\n\nfunction render_sidenote_close() {\n  return '</label></output></aside>\\n';\n}\n\n*/\n\n\nexport default function footnote_plugin(md, plugin_options) {\n  let parseLinkLabel = md.helpers.parseLinkLabel,\n      isSpace = md.utils.isSpace;\n\n  plugin_options = Object.assign({}, plugin_options, {\n    atDocumentEnd: false,\n    anchorFn: anchorFnDefault,\n    captionFn: captionFnDefault,\n    headerFn: headerFnDefault\n  });\n\n  function render_footnote_n(tokens, idx, excludeSubId) {\n    let n = Number(tokens[idx].meta.id + 1).toString();\n\n    if (!excludeSubId && tokens[idx].meta.subId > 0) {\n      n += ':' + tokens[idx].meta.subId;\n    }\n\n    return n;\n  }\n\n  function render_footnote_anchor_name(tokens, idx, options, env, slf) {\n    let n = render_footnote_n(tokens, idx, true);\n    return plugin_options.anchorFn(n, true, tokens, idx, options, env, slf);\n  }\n\n  function render_footnote_caption(tokens, idx, options, env, slf) {\n    let n = render_footnote_n(tokens, idx);\n    return plugin_options.captionFn(n, tokens, idx, options, env, slf);\n  }\n\n  function render_footnote_ref(tokens, idx, options, env, slf) {\n    let id      = slf.rules.footnote_anchor_name(tokens, idx, options, env, slf);\n    let caption = slf.rules.footnote_caption(tokens, idx, options, env, slf);\n    let refid   = render_footnote_n(tokens, idx);\n    refid = plugin_options.anchorFn(refid, false, tokens, idx, options, env, slf);\n\n    if (tokens[idx].meta.text) {\n      return '<a href=\"#fn' + id + '\" id=\"fnref' + refid + '\">' +\n            tokens[idx].meta.text +\n            '<sup class=\"footnote-ref\">' + caption + '</sup></a>';\n    }\n\n    return '<sup class=\"footnote-ref\"><a href=\"#fn' + id + '\" id=\"fnref' + refid + '\">' + caption + '</a></sup>';\n  }\n\n  function render_footnote_block_open(tokens, idx, options) {\n    let header = tokens[idx].markup;\n    return (options.xhtmlOut ? '<hr class=\"footnotes-sep\" />\\n' : '<hr class=\"footnotes-sep\">\\n') +\n         '<section class=\"footnotes\">\\n' +\n           (header ? '<h3 class=\"footnotes-header\">' + header + '</h3>' : '') +\n         '<ol class=\"footnotes-list\">\\n';\n  }\n\n  function render_footnote_block_close() {\n    return '</ol>\\n</section>\\n';\n  }\n\n  function render_footnote_reference_open(tokens, idx, options) {\n    return '<!-- footnote reference start -->\\n';\n  }\n\n  function render_footnote_reference_close() {\n    return '<!-- footnote reference end -->\\n';\n  }\n\n  function render_footnote_mark_end_of_block() {\n    return '<!-- footnote dump marker -->\\n';\n  }\n\n  function render_footnote_open(tokens, idx, options, env, slf) {\n    let id = slf.rules.footnote_anchor_name(tokens, idx, options, env, slf);\n\n/*\n  if (tokens[idx].meta.subId > 0) {\n    id += ':' + tokens[idx].meta.subId;\n  }\n*/\n\n    return '<li tabindex=\"-1\" id=\"fn' + id + '\" class=\"footnote-item\">';\n  }\n\n  function render_footnote_close() {\n    return '</li>\\n';\n  }\n\n  function render_footnote_anchor(tokens, idx, options, env, slf) {\n    let refid = render_footnote_n(tokens, idx);\n    refid = plugin_options.anchorFn(refid, false, tokens, idx, options, env, slf);\n\n    /* â†© with escape code to prevent display as Apple Emoji on iOS */\n    return ' <a href=\"#fnref' + refid + '\" class=\"footnote-backref\">\\u21a9\\uFE0E</a>';\n  }\n\n\n  md.renderer.rules.footnote_ref          = render_footnote_ref;\n  md.renderer.rules.footnote_block_open   = render_footnote_block_open;\n  md.renderer.rules.footnote_block_close  = render_footnote_block_close;\n  md.renderer.rules.footnote_reference_open   = render_footnote_reference_open;\n  md.renderer.rules.footnote_reference_close  = render_footnote_reference_close;\n  md.renderer.rules.footnote_mark_end_of_block = render_footnote_mark_end_of_block;\n  md.renderer.rules.footnote_open         = render_footnote_open;\n  md.renderer.rules.footnote_close        = render_footnote_close;\n  md.renderer.rules.footnote_anchor       = render_footnote_anchor;\n\n  // helpers (only used in other rules, no tokens are attached to those)\n  md.renderer.rules.footnote_caption      = render_footnote_caption;\n  md.renderer.rules.footnote_anchor_name  = render_footnote_anchor_name;\n\n  function find_end_of_block_marker(tokens, startIndex) {\n    let idx, len;\n    for (idx = startIndex, len = tokens.length; idx < len; idx++) {\n      if (tokens[idx].type === 'footnote_mark_end_of_block') { return idx; }\n    }\n    console.error({ tok: tokens.slice(startIndex), startIndex, idx, len });\n    throw Error('Should never get here!');\n  }\n\n  function update_end_of_block_marker(state, footnoteId) {\n    // inject marker into parent = block level token stream to announce the advent of an (inline) footnote:\n    // because the markdown_it code uses a for() loop to go through the parent nodes while parsing the\n    // 'inline' chunks, we CANNOT safely inject a marker BEFORE the chunk, only AFTERWARDS:\n    let parentState = state.env.parentState;\n    let parentIndex = state.env.parentTokenIndex;\n    let markerTokenIndex = find_end_of_block_marker(parentState.tokens, parentIndex + 1);\n    let token = parentState.tokens[markerTokenIndex];\n    if (!token.meta) token.meta = {};\n    if (!token.meta.footnote_list) token.meta.footnote_list = [];\n    token.meta.footnote_list.push(footnoteId);\n  }\n\n  // Mark end of paragraph/heading/whatever BLOCK (or rather: START of the next block!)\n  function footnote_mark_end_of_block(state, startLine, endLine, silent) {\n    if (!silent && state.tokens.length > 0) {\n      let token = state.push('footnote_mark_end_of_block', '', 0);\n      token.hidden = true;\n      token.meta = {\n      };\n    }\n    return false;\n  }\n\n  // Process footnote block definition\n  function footnote_def(state, startLine, endLine, silent) {\n    let oldBMark, oldTShift, oldSCount, oldParentType, pos, label, token,\n        initial, offset, ch, posAfterColon,\n        start = state.bMarks[startLine] + state.tShift[startLine],\n        max = state.eMarks[startLine];\n\n    // line should be at least 6 chars - \"[^x]: \" or \"[^x]:> \"\n    if (start + 5 > max) { return false; }\n\n    if (state.src.charCodeAt(start) !== 0x5B/* [ */) { return false; }\n    if (state.src.charCodeAt(start + 1) !== 0x5E/* ^ */) { return false; }\n\n    for (pos = start + 2; pos < max; pos++) {\n      if (state.src.charCodeAt(pos) === 0x20 /* space */) { return false; }\n      if (state.src.charCodeAt(pos) === 0x5D /* ] */) {\n        break;\n      }\n    }\n    let labelEnd = pos;\n\n    if (pos === start + 2) { return false; } // no empty footnote labels\n    if (pos + 1 >= max || state.src.charCodeAt(++pos) !== 0x3A /* : */) { return false; }\n    let aside_note = (state.src.charCodeAt(pos + 1) === 0x3E /* > */);\n    if (aside_note) { pos++; }\n    if (pos + 1 >= max || state.src.charCodeAt(++pos) !== 0x20 /* space */) { return false; }\n    if (silent) { return true; }\n    pos++;\n\n    if (!state.env.footnotes) { state.env.footnotes = {}; }\n    if (!state.env.footnotes.refs) { state.env.footnotes.refs = {}; }\n    label = state.src.slice(start + 2, labelEnd);\n    console.error('extracted label = ', { label, labelEnd, pos, start });\n    state.env.footnotes.refs[':' + label] = -1;\n\n    token = state.push('footnote_reference_open', '', 1);\n    token.meta = {\n      label,\n      aside: aside_note\n    };\n    token.hidden = true;\n\n    oldBMark = state.bMarks[startLine];\n    oldTShift = state.tShift[startLine];\n    oldSCount = state.sCount[startLine];\n    oldParentType = state.parentType;\n\n    posAfterColon = pos;\n    initial = offset = state.sCount[startLine] + pos - (state.bMarks[startLine] + state.tShift[startLine]);\n\n    while (pos < max) {\n      ch = state.src.charCodeAt(pos);\n\n      if (isSpace(ch)) {\n        if (ch === 0x09) {\n          offset += 4 - offset % 4;\n        } else {\n          offset++;\n        }\n      } else {\n        break;\n      }\n\n      pos++;\n    }\n\n    state.tShift[startLine] = pos - posAfterColon;\n    state.sCount[startLine] = offset - initial;\n\n    state.bMarks[startLine] = posAfterColon;\n    state.blkIndent += 4;\n    state.parentType = 'footnote';\n\n    if (state.sCount[startLine] < state.blkIndent) {\n      state.sCount[startLine] += state.blkIndent;\n    }\n\n    state.md.block.tokenize(state, startLine, endLine, true);\n\n    state.parentType = oldParentType;\n    state.blkIndent -= 4;\n    state.tShift[startLine] = oldTShift;\n    state.sCount[startLine] = oldSCount;\n    state.bMarks[startLine] = oldBMark;\n\n    token = state.push('footnote_reference_close', '', -1);\n\n    return true;\n  }\n\n  // Process inline footnotes (^[...] or ^[>...])\n  function footnote_inline(state, silent) {\n    let labelStart,\n        labelEnd,\n        footnoteId,\n        token,\n        tokens,\n        max = state.posMax,\n        start = state.pos;\n\n    if (start + 2 >= max) { return false; }\n    if (state.src.charCodeAt(start) !== 0x5E/* ^ */) { return false; }\n    if (state.src.charCodeAt(start + 1) !== 0x5B/* [ */) { return false; }\n\n    labelStart = start + 2;\n    let aside_note = (state.src.charCodeAt(start + 2) === 0x3E/* > */);\n    if (aside_note) { labelStart++; }\n    labelEnd = parseLinkLabel(state, start + 1);\n\n    // parser failed to find ']', so it's not a valid note\n    if (labelEnd < 0) { return false; }\n\n    // We found the end of the link, and know for a fact it's a valid link;\n    // so all that's left to do is to call tokenizer.\n    //\n    if (!silent) {\n      // inline blocks have their own *child* environment in markdown-it v10+.\n      // As the footnotes must live beyond the lifetime of the inline block env,\n      // we must patch them into the `parentState.env` for the footnote_tail\n      // handler to be able to access them afterwards!\n      let parentState = state.env.parentState;\n      let parentEnv = parentState.env;\n      if (!parentEnv.footnotes) { parentEnv.footnotes = {}; }\n      if (!parentEnv.footnotes.list) { parentEnv.footnotes.list = []; }\n      footnoteId = parentEnv.footnotes.list.length;\n\n      token = state.push('footnote_ref', '', 0);\n      //token.meta = { id: footnoteId, subId: 0, label: null };\n      token.meta = { id: footnoteId };\n\n      state.md.inline.parse(\n        state.src.slice(labelStart, labelEnd),\n        state.md,\n        state.env,\n        tokens = []\n      );\n\n      parentEnv.footnotes.list[footnoteId] = {\n        content: state.src.slice(labelStart, labelEnd),\n        tokens: tokens,\n        aside: aside_note\n      };\n\n      // inject marker into parent = block level token stream to announce the advent of an (inline) footnote:\n      // because the markdown_it code uses a for() loop to go through the parent nodes while parsing the\n      // 'inline' chunks, we CANNOT safely inject a marker BEFORE the chunk, only AFTERWARDS:\n      let parentIndex = state.env.parentTokenIndex;\n      let markerTokenIndex = find_end_of_block_marker(parentState.tokens, parentIndex + 1);\n      token = parentState.tokens[markerTokenIndex];\n      if (!token.meta) token.meta = {};\n      if (!token.meta.footnote_list) token.meta.footnote_list = [];\n      token.meta.footnote_list.push(footnoteId);\n\n      //md.block.ruler.enable('footnote_mark_end_of_block');\n    }\n\n    state.pos = labelEnd + 1;\n    state.posMax = max;\n    return true;\n  }\n\n  // Process footnote references with text ([^label ...])\n  function footnote_ref_with_text(state, silent) {\n    let label,\n        pos,\n        footnoteId,\n        footnoteSubId,\n        token,\n        max = state.posMax,\n        start = state.pos;\n\n    // should be at least 6 chars - \"[^l x]\"\n    if (start + 5 > max) { return false; }\n\n    if (!state.env.footnotes || !state.env.footnotes.refs) { return false; }\n    if (state.src.charCodeAt(start) !== 0x5B/* [ */) { return false; }\n    if (state.src.charCodeAt(start + 1) !== 0x5E/* ^ */) { return false; }\n\n    for (pos = start + 2; pos < max; pos++) {\n      if (state.src.charCodeAt(pos) === 0x0A /* linefeed */) { return false; }\n      if (state.src.charCodeAt(pos) === 0x5D /* ] */) {\n        break;\n      }\n    }\n\n    if (pos === start + 2) { return false; } // no empty footnote labels\n    if (pos >= max) { return false; }\n    pos++;\n\n    label = state.src.slice(start + 2, pos - 1);\n    if (!label || !label.match(/^(\\S+)\\s+(.+)$/)) { return false; }\n    label = RegExp.$1;\n    let text = RegExp.$2;\n\n    if (typeof state.env.footnotes.refs[':' + label] === 'undefined') { return false; }\n\n    if (!silent) {\n      if (!state.env.footnotes.list) { state.env.footnotes.list = []; }\n\n      if (state.env.footnotes.refs[':' + label] < 0) {\n        footnoteId = state.env.footnotes.list.length;\n        state.env.footnotes.list[footnoteId] = {\n          label,\n          count: 0\n        };\n        state.env.footnotes.refs[':' + label] = footnoteId;\n      } else {\n        footnoteId = state.env.footnotes.refs[':' + label];\n      }\n\n      footnoteSubId = state.env.footnotes.list[footnoteId].count;\n      state.env.footnotes.list[footnoteId].count++;\n\n      token = state.push('footnote_ref', '', 0);\n      token.meta = { id: footnoteId, subId: footnoteSubId, label, text };\n\n      //md.block.ruler.enable('footnote_mark_end_of_block');\n    }\n\n    state.pos = pos;\n    state.posMax = max;\n    return true;\n  }\n\n  // Process footnote references ([^...])\n  function footnote_ref(state, silent) {\n    let label,\n        pos,\n        footnoteId,\n        footnoteSubId,\n        token,\n        max = state.posMax,\n        start = state.pos;\n\n    // should be at least 4 chars - \"[^x]\"\n    if (start + 3 > max) { return false; }\n\n    if (!state.env.footnotes || !state.env.footnotes.refs) { return false; }\n    if (state.src.charCodeAt(start) !== 0x5B/* [ */) { return false; }\n    if (state.src.charCodeAt(start + 1) !== 0x5E/* ^ */) { return false; }\n\n    for (pos = start + 2; pos < max; pos++) {\n      if (state.src.charCodeAt(pos) === 0x20) { return false; }\n      if (state.src.charCodeAt(pos) === 0x0A) { return false; }\n      if (state.src.charCodeAt(pos) === 0x5D /* ] */) {\n        break;\n      }\n    }\n\n    if (pos === start + 2) { return false; } // no empty footnote labels\n    if (pos >= max) { return false; }\n    pos++;\n\n    label = state.src.slice(start + 2, pos - 1);\n    if (typeof state.env.footnotes.refs[':' + label] === 'undefined') { return false; }\n\n    if (!silent) {\n      if (!state.env.footnotes.list) { state.env.footnotes.list = []; }\n\n      if (state.env.footnotes.refs[':' + label] < 0) {\n        footnoteId = state.env.footnotes.list.length;\n        state.env.footnotes.list[footnoteId] = {\n          label,\n          count: 0\n        };\n        state.env.footnotes.refs[':' + label] = footnoteId;\n      } else {\n        footnoteId = state.env.footnotes.refs[':' + label];\n      }\n\n      footnoteSubId = state.env.footnotes.list[footnoteId].count;\n      state.env.footnotes.list[footnoteId].count++;\n\n      token = state.push('footnote_ref', '', 0);\n      token.meta = { id: footnoteId, subId: footnoteSubId, label };\n\n      //md.block.ruler.enable('footnote_mark_end_of_block');\n    }\n\n    state.pos = pos;\n    state.posMax = max;\n    return true;\n  }\n\n  // Glue footnote tokens to end of token stream\n  function footnote_tail(state, startLine, endLine, silent) {\n    let i, l, j, t, lastParagraph, token, tokens, current, currentLabel,\n        lastRefIndex = 0,\n        insideRef = false,\n        refTokens = {};\n\n    // Punch a slot into the token stream (at the very end)\n    // for consistency with footnote_mark_end_of_block():\n    //footnote_mark_end_of_block(state, startLine, endLine, silent);\n    token = new state.Token('footnote_mark_end_of_block', '', 0);\n    token.hidden = true;\n    state.tokens.push(token);\n\n    console.error('@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ TAIL');\n    if (!state.env.footnotes) { return; }\n\n    let oldLen = state.tokens.length;\n\n    // Rewrite the tokenstream to place the aside-footnotes and section footnotes where they need to be:\n    let aside_list = [];\n    let section_list = [];\n\n    // extract the tokens constituting the footnote/sidenote *content* and\n    // store that bunch in `refTokens[:<currentLabel>]` instead, to be injected back into\n    // the tokenstream at the appropriate spots.\n    state.tokens = state.tokens.filter(function (tok, idx) {\n      switch (tok.type) {\n      case 'footnote_mark_inline_footnote':\n        break;\n\n      case 'footnote_reference_open':\n        insideRef = true;\n        current = [];\n        currentLabel = tok.meta.label;\n        return true;\n\n      case 'footnote_reference_close':\n        insideRef = false;\n        // prepend ':' to avoid conflict with Object.prototype members\n        refTokens[':' + currentLabel] = current;\n        lastRefIndex = idx;\n        return true;\n      }\n      if (insideRef) {\n        current.push(tok);\n      }\n      return !insideRef;\n    });\n\n    console.error({ lastRefIndex, nextRefIndex: lastRefIndex - ((oldLen - state.tokens.length) - 1),  atDocumentEnd: plugin_options.atDocumentEnd, oldLen, tokens_length: state.tokens.length, list: state.env.footnotes.list });\n    lastRefIndex = plugin_options.atDocumentEnd ? state.tokens.length : lastRefIndex - ((oldLen - state.tokens.length) - 1);\n\n    let list = state.env.footnotes.list;\n    if (!list) { return; }\n\n    let inject_tokens = [];\n\n    token = new state.Token('footnote_block_open', '', 1);\n    token.markup = plugin_options.headerFn(state);\n    inject_tokens.push(token);\n\n    for (i = 0, l = list.length; i < l; i++) {\n      token      = new state.Token('footnote_open', '', 1);\n      token.meta = { id: i, label: list[i].label };\n      inject_tokens.push(token);\n\n      if (list[i].tokens) {\n        // process an inline footnote text:\n        token          = new state.Token('paragraph_open', 'p', 1);\n        token.block    = true;\n        inject_tokens.push(token);\n\n        token          = new state.Token('inline', '', 0);\n        token.children = list[i].tokens;\n        token.content  = list[i].content;\n        inject_tokens.push(token);\n\n        token          = new state.Token('paragraph_close', 'p', -1);\n        token.block    = true;\n        inject_tokens.push(token);\n      } else if (list[i].label) {\n        // process a labeled footnote:\n        inject_tokens = inject_tokens.concat(refTokens[':' + list[i].label] || []);\n      } else {\n        // nothing to inject\n        throw Error('unexpected: should never get here!');\n      }\n\n      if (inject_tokens[inject_tokens.length - 1].type === 'paragraph_close') {\n        lastParagraph = inject_tokens.pop();\n      } else {\n        lastParagraph = null;\n      }\n\n      t = list[i].count > 0 ? list[i].count : 1;\n      for (j = 0; j < t; j++) {\n        token      = new state.Token('footnote_anchor', '', 0);\n        token.meta = { id: i, subId: j, label: list[i].label };\n        inject_tokens.push(token);\n      }\n\n      if (lastParagraph) {\n        inject_tokens.push(lastParagraph);\n      }\n\n      token = new state.Token('footnote_close', '', -1);\n      inject_tokens.push(token);\n    }\n\n    token = new state.Token('footnote_block_close', '', -1);\n    inject_tokens.push(token);\n    state.tokens.splice(lastRefIndex, 0, ...inject_tokens);\n  }\n\n  // attach ourselves to the start of block handling too\n  md.block.ruler.before('table', 'footnote_mark_end_of_block', footnote_mark_end_of_block);\n\n  md.block.ruler.before('reference', 'footnote_def', footnote_def, { alt: [ 'paragraph', 'reference' ] });\n  md.inline.ruler.after('image', 'footnote_inline', footnote_inline);\n  md.inline.ruler.after('footnote_inline', 'footnote_ref_with_text', footnote_ref_with_text);\n  md.inline.ruler.after('footnote_ref_with_text', 'footnote_ref', footnote_ref);\n  md.core.ruler.after('inline', 'footnote_tail', footnote_tail);\n  //throw 1;\n  console.log({ par: md.block.ruler.__rules__ });\n}\n"],"names":["anchorFnDefault","n","excludeSubId","tokens","idx","options","env","slf","prefix","docId","length","captionFnDefault","headerFnDefault","state","footnote_plugin","md","plugin_options","parseLinkLabel","helpers","isSpace","utils","Object","assign","atDocumentEnd","anchorFn","captionFn","headerFn","render_footnote_n","Number","meta","id","toString","subId","render_footnote_anchor_name","render_footnote_caption","render_footnote_ref","rules","footnote_anchor_name","caption","footnote_caption","refid","text","render_footnote_block_open","header","markup","xhtmlOut","render_footnote_block_close","render_footnote_reference_open","render_footnote_reference_close","render_footnote_mark_end_of_block","render_footnote_open","render_footnote_close","render_footnote_anchor","renderer","footnote_ref","footnote_block_open","footnote_block_close","footnote_reference_open","footnote_reference_close","footnote_mark_end_of_block","footnote_open","footnote_close","footnote_anchor","find_end_of_block_marker","startIndex","len","type","console","error","tok","slice","Error","startLine","endLine","silent","token","push","hidden","footnote_def","oldBMark","oldTShift","oldSCount","oldParentType","pos","label","initial","offset","ch","posAfterColon","start","bMarks","tShift","max","eMarks","src","charCodeAt","labelEnd","aside_note","footnotes","refs","aside","sCount","parentType","blkIndent","block","tokenize","footnote_inline","labelStart","footnoteId","posMax","parentState","parentEnv","list","inline","parse","content","parentIndex","parentTokenIndex","markerTokenIndex","footnote_list","footnote_ref_with_text","footnoteSubId","match","RegExp","$1","$2","count","footnote_tail","i","l","j","t","lastParagraph","current","currentLabel","lastRefIndex","insideRef","refTokens","Token","oldLen","filter","nextRefIndex","tokens_length","inject_tokens","children","concat","pop","splice","ruler","before","alt","after","core","log","par","__rules__"],"mappings":"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"}