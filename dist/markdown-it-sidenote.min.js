!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownitFootnote=e()}}(function(){return function(){return function e(n,t,r){function o(i,u){if(!t[i]){if(!n[i]){var d="function"==typeof require&&require;if(!u&&d)return d(i,!0);if(s)return s(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var l=t[i]={exports:{}};n[i][0].call(l.exports,function(e){return o(n[i][1][e]||e)},l,l.exports,e,n,t,r)}return t[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}}()({1:[function(e,n,t){"use strict";function r(e,n,t,r){var o=Number(e[n].meta.id+1).toString(),s="";return"string"==typeof r.docId&&(s="-"+r.docId+"-"),s+o}function o(e,n){var t=Number(e[n].meta.id+1).toString();return e[n].meta.subId>0&&(t+=":"+e[n].meta.subId),"["+t+"]"}function s(e,n,t,r,o){var s=o.rules.sidenote_anchor_name(e,n,t,r,o),i=o.rules.sidenote_caption(e,n,t,r,o),u=s;return e[n].meta.subId>0&&(u+=":"+e[n].meta.subId),'<sup class="sidenote-ref"><a href="#fn'+s+'" id="fnref'+u+'">'+i+"</a></sup>"}function i(e,n,t,r,o){var s=o.rules.sidenote_anchor_name(e,n,t,r,o);return e[n].meta.subId>0&&(s+=":"+e[n].meta.subId),`<aside id="fn${s}" class="sidenote" role="note">\n    <output aria-hidden="true" class="highlight" id="fn${s}-content">\n    <label role="presentation" for="fnref${s}">`}function u(){return"</label></output></aside>\n"}function d(e,n,t,r,o){var s=o.rules.sidenote_anchor_name(e,n,t,r,o);return e[n].meta.subId>0&&(s+=":"+e[n].meta.subId),' <a href="#fnref'+s+'" class="sidenote-backref">\u21a9\ufe0e</a>'}n.exports=function(e){var n=e.helpers.parseLinkLabel;function t(e){return e.children&&e.children.some(e=>"sidenote_ref"===e.type)}function a(e,n,t){const r=[];var o=new e.Token("sidenote_open","",1);let s;o.meta={id:t,label:n.label},r.push(o),n.tokens&&((o=new e.Token("paragraph_open","p",1)).block=!0,r.push(o),(o=new e.Token("inline","",0)).children=n.tokens,o.content=n.content,r.push(o),(o=new e.Token("paragraph_close","p",-1)).block=!0,r.push(o)),s="paragraph_close"===r[r.length-1].type?r.pop():null;const i=n.count>0?n.count:1;for(let s=0;s<i;s++)(o=new e.Token("sidenote_anchor","",0)).meta={id:t,subId:s,label:n.label},r.push(o);return s&&r.push(s),o=new e.Token("sidenote_close","",-1),r.push(o),r}e.renderer.rules.sidenote_ref=s,e.renderer.rules.sidenote_open=i,e.renderer.rules.sidenote_close=u,e.renderer.rules.sidenote_anchor=d,e.renderer.rules.sidenote_caption=o,e.renderer.rules.sidenote_anchor_name=r,e.inline.ruler.after("image","sidenote_inline",function(e,t){var r,o,s,i=[],u=e.posMax,d=e.pos;return!(d+2>=u||94!==e.src.charCodeAt(d)||91!==e.src.charCodeAt(d+1)||(r=d+2,(o=n(e,d+1))<0||(t||(e.env.sidenotes||(e.env.sidenotes={}),e.env.sidenotes.list||(e.env.sidenotes.list=[]),s=e.env.sidenotes.list.length,e.md.inline.parse(e.src.slice(r,o),e.md,e.env,i),e.push("sidenote_ref","",0).meta={id:s},e.env.sidenotes.list[s]={content:e.src.slice(r,o),tokens:i}),e.pos=o+1,e.posMax=u,0)))}),e.core.ruler.after("inline","sidenote_tail",function(e){if(!e.env.sidenotes)return;const n=e.env.sidenotes.list,r=[];for(;n.length;){const o=n.pop();let s=e.tokens.pop();for(;"inline"!==s.type||!t(s);)r.push(s),s=e.tokens.pop();if(!t(s))throw new Error("missing sidenote ref");const i=[s];for(s=r.pop();"paragraph_close"!==s.type;)i.push(s),s=r.tokens.pop();i.push(s);const u=a(e,o,n.length);u.reverse(),r.push(...u),i.reverse(),r.push(...i)}r.reverse(),e.tokens.push(...r)})}},{}]},{},[1])(1)});
